<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link rel="icon" type="image/png" href="https://hsitxpt.github.io/outlook-snippet-addin/assets/icon-64.png" />
    <link rel="shortcut icon" type="image/png" href="https://hsitxpt.github.io/outlook-snippet-addin/assets/icon-64.png" />
    <title>ITXPT Labeling Templates</title>

    <!-- Office UI Fabric CSS -->
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css" />

    <!-- Custom CSS -->
    <link rel="stylesheet" type="text/css" href="taskpane.css?v=1.1" />
</head>
<body class="ms-font-m ms-welcome ms-Fabric">
    <header class="ms-welcome__header ms-bgColor-neutralLighter ms-u-fadeIn500">
        <div class="logo-container">
            <span class="logo-text">ITXPT</span>
        </div>
        <h1 class="header-title">ITXPT Labeling Templates</h1>
        <p class="header-subtitle">Structured templates for labeling workflows</p>
        <div id="version-indicator" style="margin-top: 8px; padding: 4px 8px; background: rgba(255,255,255,0.2); border-radius: 4px; font-size: 11px; font-weight: 600;">
            Version 1.8.0 | Updated: <span id="build-time">Loading...</span>
        </div>
    </header>
    <main id="app-body" class="ms-welcome__main ms-u-fadeIn500">
        <div class="container">
            <!-- Workflow Snippets Section -->
            <section class="section workflow-snippets">
                <div class="section-header">
                    <span class="section-icon">ğŸ“‹</span>
                    <h2 class="section-title">Workflow Snippets</h2>
                </div>
                <div class="form-group">
                    <label for="workflow-snippet-type" class="form-label">
                        <span class="label-icon">ğŸ“§</span>
                        Select Snippet Type
                    </label>
                    <select id="workflow-snippet-type" class="form-select">
                        <option value="none">-- Select workflow snippet --</option>
                        <option value="documentation-request">ğŸ“„ Documentation Request</option>
                        <option value="remote-session-setup">ğŸ–¥ï¸ Remote Session Setup</option>
                        <option value="lab-shipping-instructions">ğŸ“¦ Lab Shipping Instructions</option>
                        <option value="test-results-report">ğŸ“Š Test Results Report</option>
                        <option value="custom-template">âœï¸ Custom Template (Form Below)</option>
                    </select>
                </div>
                <div id="workflow-snippet-fields" class="workflow-snippet-fields" style="display: none;">
                    <!-- Dynamic fields will be inserted here based on snippet type -->
                </div>
                <button id="insert-workflow-snippet-btn" class="btn btn-primary btn-full" style="display: none;">
                    <span class="btn-icon">ğŸ“§</span>
                    <span>Insert Workflow Snippet</span>
                </button>
            </section>

            <!-- Quick Actions -->
            <section class="section quick-actions">
                <button id="load-preset-btn" class="quick-btn" title="Load template preset">
                    <span class="icon">ğŸ“‹</span>
                    <span>Presets</span>
                </button>
                <button id="save-preset-btn" class="quick-btn" title="Save current as preset">
                    <span class="icon">ğŸ’¾</span>
                    <span>Save</span>
                </button>
                <button id="auto-fill-btn" class="quick-btn" title="Auto-fill from email">
                    <span class="icon">âš¡</span>
                    <span>Auto-fill</span>
                </button>
            </section>

            <!-- Deadline Section (shown when custom-template is selected) -->
            <section id="deadline-section" class="section" style="display: none;">
                <div class="section-header">
                    <span class="section-icon">â°</span>
                    <h2 class="section-title">Deadline Information</h2>
                </div>
                <div class="form-row">
                    <div class="form-group form-group-half">
                        <label for="deadline-date" class="form-label">
                            <span class="label-icon">ğŸ“…</span>
                            Deadline Date
                        </label>
                        <input type="date" id="deadline-date" class="form-input" />
                    </div>
                    <div class="form-group form-group-half">
                        <label for="deadline-time" class="form-label">
                            <span class="label-icon">ğŸ•</span>
                            Time
                        </label>
                        <input type="time" id="deadline-time" class="form-input" />
                    </div>
                </div>
            </section>

            <!-- Custom Template Section (shown when custom-template is selected) -->
            <section id="custom-template-section" class="section" style="display: none;">
                <div class="section-header">
                    <span class="section-icon">ğŸ“</span>
                    <h2 class="section-title">Process Step</h2>
                </div>
                <div class="form-group">
                    <label for="process-stage" class="form-label">
                        <span class="label-icon">ğŸ”„</span>
                        Current Step
                    </label>
                    <select id="process-stage" class="form-select">
                        <option value="">Select step...</option>
                        <option value="planning">ğŸ“‹ Planering</option>
                        <option value="preparation">ğŸ”§ FÃ¶rberedelse</option>
                        <option value="testing">ğŸ§ª Testning pÃ¥gÃ¥r</option>
                        <option value="review">ğŸ‘€ Granskning</option>
                        <option value="finalization">âœ… Finalisering</option>
                        <option value="completed">âœ“ Klart</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="planner-ticket" class="form-label">
                        <span class="label-icon">ğŸ«</span>
                        Planner Ticket ID
                    </label>
                    <input type="text" id="planner-ticket" class="form-input" placeholder="e.g. LAB-123" />
                </div>
            </section>

            <!-- Tests Section (shown when custom-template is selected) -->
            <section id="tests-section" class="section" style="display: none;">
                <div class="section-header">
                    <span class="section-icon">ğŸ§ª</span>
                    <h2 class="section-title">Completed Tests</h2>
                    <span id="test-count" class="badge">0</span>
                </div>
                <div id="tests-container" class="tests-container">
                    <!-- Tests will be added dynamically -->
                </div>
                <button id="add-test-btn" class="btn btn-secondary btn-full">
                    <span class="btn-icon">â•</span>
                    <span>Add Test</span>
                </button>
            </section>

            <!-- Additional Notes (shown when custom-template is selected) -->
            <section id="notes-section" class="section" style="display: none;">
                <div class="section-header">
                    <span class="section-icon">ğŸ“</span>
                    <h2 class="section-title">Additional Information</h2>
                </div>
                <div class="form-group">
                    <label for="additional-notes" class="form-label">
                        <span class="label-icon">ğŸ“„</span>
                        Notes
                    </label>
                    <textarea id="additional-notes" class="form-textarea" rows="4" placeholder="Add additional information about the session..."></textarea>
                    <div class="char-count">
                        <span id="notes-char-count">0</span> / 500 characters
                    </div>
                </div>
            </section>

            <!-- Action Buttons (shown when custom-template is selected) -->
            <section id="action-section" class="section action-section" style="display: none;">
                <button id="insert-template-btn" class="btn btn-primary btn-full btn-large">
                    <span class="btn-icon">ğŸ“§</span>
                    <span>Insert Template into Email</span>
                </button>
                <div class="button-group">
                    <button id="preview-btn" class="btn btn-outline btn-half">
                        <span class="btn-icon">ğŸ‘ï¸</span>
                        <span>Preview</span>
                    </button>
                    <button id="clear-form-btn" class="btn btn-outline btn-half">
                        <span class="btn-icon">ğŸ—‘ï¸</span>
                        <span>Clear</span>
                    </button>
                </div>
            </section>
        </div>
    </main>

    <!-- Preview Modal -->
    <div id="preview-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Template Preview</h3>
                <button class="modal-close" id="close-preview">&times;</button>
            </div>
            <div class="modal-body" id="preview-content">
                <!-- Preview content will be inserted here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="insert-from-preview">Insert into Email</button>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="test-templates.js"></script>
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
    <script type="text/javascript">
        // Immediate inline script to verify script execution
        console.log("%cğŸ”µ INLINE SCRIPT EXECUTED", "color: blue; font-size: 20px; font-weight: bold;");
        console.log("HTML loaded, about to load taskpane.js");
        window.addInLoaded = false;
    </script>
    <script type="text/javascript" src="taskpane.js?v=1.8"></script>
    <script type="text/javascript">
        // Verify script loaded
        setTimeout(function() {
            if (!window.addInLoaded) {
                console.error("%câŒ taskpane.js DID NOT LOAD PROPERLY", "color: red; font-size: 20px; font-weight: bold;");
                document.body.innerHTML = '<div style="padding: 20px; color: red;"><h2>Error: JavaScript failed to load</h2><p>Check console for details.</p></div>' + document.body.innerHTML;
            } else {
                console.log("%câœ… Script loaded successfully", "color: green; font-size: 16px;");
            }
        }, 2000);
    </script>
</body>
</html>

